{{ define "content" }}
<div>
    <div class="flex items-center">
        <button class="action-button" onclick="window.history.back()">
            <i class="fa-solid fa-chevron-left"></i> Back
        </button>
        <h3 class="text-base font-semibold ml-4">{{.ProblemPtr.Code}}</h3>
        <div class="flex space-x-4 ml-auto pr-4">
            <button class="action-button" 
                hx-get="/problems/edit-problem?id={{.ProblemPtr.ID}}&curriculum_id={{.ProblemPtr.CurriculumID}}&topic_id={{.ProblemPtr.TopicID}}"
                hx-target="body" hx-push-url="true">
                <i class="fa-solid fa-pen">
                </i></button>
            <button class="action-button" hx-delete="/archive-problem?id={{.ProblemPtr.ID}}" hx-ext="goBackAfter"
                hx-confirm="Are you sure you want to delete problem?">
                <i class="fa-solid fa-trash">
                </i></button>
        </div>
    </div>
    <div class="bg-white p-6 rounded-lg shadow-md" data-mathjax="true">
        <h2 class="text-lg font-semibold">
            STATEMENT/TEXT
        </h2>
        <p class="mt-2">
            {{.ProblemPtr.MetaData.Question}}
        </p>
        {{ if .ProblemPtr.Concepts }}
        <h2 class="text-lg font-semibold mt-4">
            CONCEPTS
        </h2>
        <p class="mt-2">
            {{ range $index, $concept := .ProblemPtr.Concepts }}
                {{ if $index }}, {{ end }}{{ getName $concept "en" }}
            {{ end }}
        </p>
        {{ end }}
        <h2 class="text-lg font-semibold mt-4">
            SKILL
        </h2>
        <p class="mt-2">
            {{ range $index, $skill := .ProblemPtr.Skills }}
                {{ if $index }}, {{ end }}{{ $skill.Name }}
            {{ end }}
        </p>
        {{ if .ProblemPtr.MetaData.Options }}
        <h2 class="text-lg font-semibold mt-4">
            OPTIONS
        </h2>
        <div class="mt-2 border border-gray-300">
            {{ range $index, $option := .ProblemPtr.MetaData.Options }}
            <div class="flex items-center border-b border-gray-300 p-4">
                <span class="mr-8 font-semibold">
                    {{ printf "%c" (add 65 $index) }}    <!-- Convert ASCII to letter -->
                </span>
                <p>{{ $option }}</p>
            </div>
            {{ end }}
        </div>
        {{ end }}
        <h2 class="text-lg font-semibold mt-4">
            ANSWER
        </h2>
        <p class="mt-2">
            {{ if eq .ProblemPtr.Subtype "mcq_single_answer" }}
                {{ range .ProblemPtr.MetaData.Answers }}
                    {{ printf "%c" (add 64 (stringToInt .)) }}
                {{ end }}
            {{ else }}
                {{ range .ProblemPtr.MetaData.Answers }}
                    {{ . }}
                {{ end }}
            {{ end }}
        </p>
        <h2 class="text-lg font-semibold mt-4">
            SOLUTION
        </h2>
        <p class="mt-2">
            {{ if gt (len .ProblemPtr.MetaData.Solutions) 0 }}
                {{ (index .ProblemPtr.MetaData.Solutions 0).Value }}
            {{ else }}
                No solution available.
            {{ end }}
        </p>
        <h2 class="text-lg font-semibold mt-4">
            DIFFICULTY RATING
        </h2>
        <div class="mt-2 flex items-center text-yellow-400">
            {{ range $i := seq 1 3 }}
                {{ if le $i $.ProblemPtr.DisplayDifficulty }}
                    <!-- Filled star -->
                    <i class="fa-solid fa-star"></i>
                {{ else }}
                    <i class="fa-regular fa-star text-gray-300"></i>
                {{ end }}
            {{ end }}
        </div>
    </div>
</div>
<script>
    htmx.defineExtension('goBackAfter', {
            onEvent: function (name, evt) {
                if (name === 'htmx:afterRequest') {
                    history.back();
                }
            }
        }
    );
</script>
{{ end }}